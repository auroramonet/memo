<!doctype html><html lang=en-US dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Epoch 8: Makemore, Part 5 | Memo Box</title><meta property="og:title" content="Epoch 8: Makemore, Part 5"><meta property="og:type" content="article"><meta property="og:url" content="https://auroramonet.github.io/memo/posts/epoch8/"><meta property="og:image" content="https://files.catbox.moe/zh3y51.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://files.catbox.moe/zh3y51.png"><link rel=icon type=image/svg+xml href=/memo/favicon.svg><link rel=apple-touch-icon href=/memo/favicon.svg><meta name=theme-color content="#1a202c"><link rel=stylesheet href=/memo/css/main.min.7fa279f525716b6c44ad4d86208dcd4c1fb7ea3ce69b8f00834bf701768f3a60.css integrity="sha256-f6J59SVxa2xErU2GII3NTB+36jzmm48Ag0v3AXaPOmA=" crossorigin=anonymous><link rel=stylesheet href=/memo/css/custom.min.a6a3eb7060356ad051e321fafd01ddc5b490e51f57e274b266d67cdeaea302f4.css integrity="sha256-pqPrcGA1atBR4yH6/QHdxbSQ5R9X4nSyZtZ83q6jAvQ=" crossorigin=anonymous><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},svg:{fontCache:"global"}}</script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css><script src=https://cdn.jsdelivr.net/npm/glightbox/dist/js/glightbox.min.js></script></head><body><header><nav class=path-nav><ul><li>/
<a href=/memo/>Memo Box</a>
/</li><li><a href=/memo/posts/>Posts</a>
/</li><li class=current><a href=/memo/posts/epoch8/>Epoch 8: Makemore, Part 5</a></li></ul></nav></header><main><h1>Epoch 8: Makemore, Part 5</h1><nav class=toc><strong>Table of contents</strong><div class=toc-content><nav id=TableOfContents><ul><li><a href=#intro>Intro</a></li><li><a href=#content-mlp-part-4>Content: MLP Part 4</a></li><li><a href=#resources>Resources</a></li></ul></nav></div></nav><h2 class=no-counter id=intro>Intro</h2><p>Hi, I&rsquo;m Mon, in the previous epoch we learnt how to make mlp of makemore. In this epoch we learn more about Activations, gradients and BatchNorm.</p><h2 class=no-counter id=content-mlp-part-4>Content: MLP Part 4</h2><p>Let&rsquo;s make our MLP again</p><ol><li>dictionary:<br><img src=https://auroramonet.github.io/memo/img/epoch8-dictionary.png alt=epoch8-dictionary></li></ol><pre tabindex=0><code class=language-python-copy data-lang=python-copy>#dictionary 

words = open(&#39;names.txt&#39;, &#39;r&#39;).read().splitlines()
chars = sorted(list(set(&#39;&#39;.join(words))))
stoi = {s: i+1 for i,s in enumerate(chars)}
stoi[&#39;.&#39;] = 0
itos = {i:s for s,i in stoi.items()}
vocab_size = len(itos)
print(itos)
print(vocab_size)
</code></pre><br>2. dataset:<br><p><img src=https://auroramonet.github.io/memo/img/epoch8-dataset.png alt=epoch8-dataset></p><pre tabindex=0><code class=language-python-copy data-lang=python-copy># build the dataset
block_size = 3 #context length

def build_dataset(words):  
  X, Y = [], []
  
  for w in words:
    context = [0] * block_size
    for ch in w + &#39;.&#39;:
      ix = stoi[ch]
      X.append(context)
      Y.append(ix)
      context = context[1:] + [ix] # crop and append

  X = torch.tensor(X)
  Y = torch.tensor(Y)
  print(X.shape, Y.shape)
  return X, Y

import random
random.seed(42)
random.shuffle(words)
n1 = int(0.8*len(words))
n2 = int(0.9*len(words))

Xtr,  Ytr  = build_dataset(words[:n1])     # 80%
Xdev, Ydev = build_dataset(words[n1:n2])   # 10%
Xte,  Yte  = build_dataset(words[n2:])     # 10%
</code></pre><br>3. init:<br><p><img src=https://auroramonet.github.io/memo/img/epoch8-init.png alt=epoch8-init></p><pre tabindex=0><code class=language-python-copy data-lang=python-copy># MLP init

n_embd = 10 # dim of character embedding
n_hidden = 200 # the number of neurons in the hidden layer of the MLP

g = torch.Generator().manual_seed(2147483647)
C  = torch.randn((vocab_size, n_embd),            generator=g)
W1 = torch.randn((n_embd * block_size, n_hidden), generator=g)
b1 = torch.randn(n_hidden,                        generator=g)
W2 = torch.randn((n_hidden, vocab_size),          generator=g)
b2 = torch.randn(vocab_size,                      generator=g)

parameters = [C, W1, b1, W2, b2]
print(sum(p.nelement() for p in parameters)) # number of parameters in total
for p in parameters:
  p.requires_grad = True
</code></pre><br>4. autograd:<br><h2 class=no-counter id=resources>Resources</h2><h3 id=an-autoregressive-character-level-language-model-for-making-more-things>An autoregressive character-level language model for making more things</h3><p><a href=https://github.com/karpathy/makemore>GitHub: karpathy/makemore</a></p><h3 id=the-spelled-out-intro-to-language-modeling-building-makemore>The spelled-out intro to language modeling: building makemore</h3><iframe width=560 height=315 src=https://www.youtube.com/embed/P6sfmUTpUmc title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy=strict-origin-when-cross-origin allowfullscreen></iframe><h3 id=google-colab-notebook>Google Colab Notebook</h3><p><a href="https://colab.research.google.com/drive/1H5CSy-OnisagUgDUXhHwo1ng2pjKHYSN?usp=sharing#scrollTo=W4LMs4kwr6OW">Google Colab: Makemore Part 5</a></p><div class=time><time datetime=2026-01-11>2026-01-11&nbsp;</time></div><div class=comments></div><div class=terminal-nav><div class=back-nav><a href=../ class=back-link>../</a></div></div></main><footer></footer><script>document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll("main article img, main .content img, main img");e.forEach(function(e){if(e.parentElement.tagName==="A")return;const t=document.createElement("a");t.href=e.src,t.setAttribute("data-glightbox",""),t.setAttribute("data-gallery","gallery"),e.alt&&t.setAttribute("data-title",e.alt),e.parentNode.insertBefore(t,e),t.appendChild(e)});const n=GLightbox({selector:"a[data-glightbox]",touchNavigation:!0,loop:!0,autoplayVideos:!1}),t=document.querySelectorAll('code.language-python-copy, code[class*="python-copy"], code[data-lang="python-copy"]');t.forEach(function(e){let o=e.textContent||e.innerText;const n=e.closest("pre");if(!n)return;const i=n.parentElement;if(!i)return;n.style.display="none";const s=document.createElement("div");s.className="code-copy-container";const t=document.createElement("button");t.className="code-copy-button",t.textContent="Copy Code",t.setAttribute("aria-label","Copy code to clipboard"),t.addEventListener("click",function(){if(navigator.clipboard&&navigator.clipboard.writeText)navigator.clipboard.writeText(o).then(function(){t.textContent="Copied!",t.classList.add("copied"),setTimeout(function(){t.textContent="Copy Code",t.classList.remove("copied")},2e3)}).catch(function(e){console.error("Failed to copy code:",e),t.textContent="Failed",setTimeout(function(){t.textContent="Copy Code"},2e3)});else{const e=document.createElement("textarea");e.value=o,e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.select();try{document.execCommand("copy"),t.textContent="Copied!",t.classList.add("copied"),setTimeout(function(){t.textContent="Copy Code",t.classList.remove("copied")},2e3)}catch(e){console.error("Failed to copy code:",e),t.textContent="Failed",setTimeout(function(){t.textContent="Copy Code"},2e3)}document.body.removeChild(e)}}),s.appendChild(t),i.insertBefore(s,n)})})</script></body></html>